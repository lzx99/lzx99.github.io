

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="https://s3.ax1x.com/2021/01/12/sJsf0O.png">
  <link rel="icon" href="https://s3.ax1x.com/2021/01/12/sJsf0O.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="新">
  <meta name="keywords" content="">
  
    <meta name="description" content="SpringSpring思想源于EJB（Enterprise JavaBean），传统JavaEE的EJB现在已被Spring家族淘汰，Spring基于IOC思想开发。是一个IoC和AOP容器框架，松耦合+少入侵。Spring中设计模式  IOC（Inversion of Control，控制反转） DI（Dependency Injection，依赖注入） AOP（Aspect Oriented">
<meta property="og:type" content="article">
<meta property="og:title" content="新&#39;s Blog">
<meta property="og:url" content="http://example.com/2022/11/14/Java/SSM/index.html">
<meta property="og:site_name" content="新&#39;s Blog">
<meta property="og:description" content="SpringSpring思想源于EJB（Enterprise JavaBean），传统JavaEE的EJB现在已被Spring家族淘汰，Spring基于IOC思想开发。是一个IoC和AOP容器框架，松耦合+少入侵。Spring中设计模式  IOC（Inversion of Control，控制反转） DI（Dependency Injection，依赖注入） AOP（Aspect Oriented">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-11-14T08:30:04.000Z">
<meta property="article:modified_time" content="2022-11-14T08:30:04.000Z">
<meta property="article:author" content="新">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>新&#39;s Blog</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.3","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":6},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"AxRSoPrgAA1n3akIHe4aBQ2Y-gzGzoHsz","app_key":"CYOBLQ2l1KRnfhA3E4xX91CI","server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  

  

  
    
  



  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>新&#39;s Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text=""></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-11-14 16:30" pubdate>
          2022年11月14日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          <!-- compatible with older versions-->
          24k 字
        
      </span>
    

    

    
    
      
        <span id="leancloud-page-views-container" class="post-meta" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="leancloud-page-views"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none"></h1>
            
            
              <div class="markdown-body">
                
                <h2 id="Spring"><a href="#Spring" class="headerlink" title="Spring"></a>Spring</h2><h4 id="Spring思想"><a href="#Spring思想" class="headerlink" title="Spring思想"></a>Spring思想</h4><p>源于EJB（Enterprise JavaBean），传统JavaEE的EJB现在已被Spring家族淘汰，Spring基于IOC思想开发。是一个IoC和AOP容器框架，松耦合+少入侵。<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/66790602">Spring中设计模式</a></p>
<ul>
<li>IOC（Inversion of Control，控制反转）</li>
<li>DI（Dependency Injection，依赖注入）</li>
<li>AOP（Aspect Oriented Programming，面向切面编程）：鉴定权利、日志打印跟事务处理。</li>
</ul>
<h4 id="开启Spring容器"><a href="#开启Spring容器" class="headerlink" title="开启Spring容器"></a>开启Spring容器</h4><ol>
<li>编写Spring的配置文件</li>
</ol>
<p>Spring配置文件（习惯命名applicationContext.xml）的作用在于配置注解扫描（也可以用类上声明@Configuration+@Bean注册），和注册Bean</p>
<ol start="2">
<li>加载配置资源，创建BeanFactory</li>
</ol>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-comment">//1.Application接受Spring容器，是BeanFactory的子类，创建时就初始化所有Bean，类路径/绝对路径</span><br>ApplicationContext context = <span class="hljs-keyword">new</span><span class="hljs-constructor">ClassPathXmlApplicationContext(<span class="hljs-string">&quot;applicationContext.xml&quot;</span>)</span>;<br><span class="hljs-keyword">new</span> <span class="hljs-constructor">FileSystemXmlApplicationContext(<span class="hljs-string">&quot;c:/applicatioContext.xml&quot;</span>)</span>;<br>UserService UserService = (Userservice)context.get<span class="hljs-constructor">Bean(<span class="hljs-string">&quot;userServiceImpl&quot;</span>)</span>;<br><span class="hljs-comment">//2. XmlBeanFactory+ClasspathResource获取（过时），getBean时才初始化</span><br>BeanFactory factory = <span class="hljs-keyword">new</span> <span class="hljs-constructor">XmlBeanFactory(<span class="hljs-params">newClassPathResource</span>(<span class="hljs-string">&quot;applicationContext.xml&quot;</span>)</span>;);<br><span class="hljs-comment">//读取注解配置类：</span><br>ctx = <span class="hljs-keyword">new</span> <span class="hljs-constructor">AnnotationConfigApplicationContext(ApplicationContextConfig.<span class="hljs-params">class</span>)</span>;<br></code></pre></td></tr></table></figure>

<h4 id="注册Bean"><a href="#注册Bean" class="headerlink" title="注册Bean"></a>注册Bean</h4><ul>
<li><p><strong>@Component、@Controller、@Service、@Repository</strong>，注册Bean，默认Bean的ID&#x3D;小写的类名。</p>
<p>Repository注解很少使用，因为经常用MapperScanner给我们扫描了dao层，注册到了容器中</p>
</li>
<li><p>注册Bean：<strong>id和class属性（类的位置，不是接口位置）</strong>是必须属性，尤其是class。</p>
<p>xml注册Bean、注解注册Bean、类注册（@configuration注解放在配置类上，@Bean注解放在返会类对象的方法上）</p>
</li>
</ul>
<h4 id="Spring注入"><a href="#Spring注入" class="headerlink" title="Spring注入"></a>Spring注入</h4><p>spring的注入是指在启动spring容器加载Bean配置的时候，<strong>完成对对变量的赋值行为</strong>。常见的spring注入的方式有两种，分别是设值注入和构造注入。</p>
<ol>
<li><p>值注入</p>
</li>
<li><p><strong>@Value：</strong>可以从配置文件读取时，如@Value(“${driver.name}”)</p>
</li>
<li><p>xml配置的设值注入依赖于setter，在注册Bean里设置property，视图解析器等等Bean已经配过很多次了</p>
</li>
<li><p>依赖注入</p>
</li>
<li><p>@Autowired：按byType自动装配，如果在容器中装配的类型有多个bean，自动再按名字自动装配。</p>
<p>@Resource ：优先按定义的属性名byName自动装配，后按照type匹配。多个实现时，@Resource(name&#x3D;”car”)，等于</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Resource(name=&quot;cookFish&quot;)</span><br><span class="hljs-comment">// 等于</span><br><span class="hljs-meta">@Resource</span><br><span class="hljs-meta">@Qualifier(&quot;cookFish&quot;)</span><br></code></pre></td></tr></table></figure></li>
</ol>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-comment">// 写在这个属性的setter方法上（需要有）</span><br><span class="hljs-meta">@Autowired</span><br><span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">setCar</span>(<span class="hljs-params">IVehicle car</span>) &#123;<br> <span class="hljs-variable language_">this</span>.<span class="hljs-property">car</span> = car;<br>&#125;<br><span class="hljs-comment">// 写在构造器参数前面，当我们调用这个构造方法创建Bean时</span><br><span class="hljs-keyword">public</span> <span class="hljs-title class_">Driver</span>(<span class="hljs-title class_">String</span> name, <span class="hljs-meta">@Autowired</span> <span class="hljs-title class_">IVehicle</span> vehicle) &#123;<br> <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;<br> <span class="hljs-variable language_">this</span>.<span class="hljs-property">car</span> = vehicle;<br>&#125;<br></code></pre></td></tr></table></figure>

<ol>
<li>Bean设置里的设置property的ref就是依赖注入整个对象，需要setter。也可以通过xml构造器依赖注入。</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;eDao&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;empdao&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-comment">&lt;!-- 或者 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;edao&quot;</span> &gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">ref</span> <span class="hljs-attr">bean</span>=<span class="hljs-string">&quot;empdao&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">ref</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br></code></pre></td></tr></table></figure>

<ol>
<li><strong>xml自动依赖注入</strong>，在bean标签中，设置<strong>autowire</strong>&#x3D;”byName”或者autowire&#x3D; “byType”（还有constructor和default，一般不用）<br>例如：bean中有一个属性是IPerson类型，如果配置了按类型装配，就会到容器中找类型是IPerson的bean,注入到属性中，但是IPerson有多个实现类时，会报错。</li>
</ol>
<p>类型自动装配缺点：容器中只能有一个该类型的bean（Ivehicle属性只能有一个继承类） ，多个继承类，会出现下面的异常：</p>
<ol start="3">
<li>更改默认无参构造器</li>
</ol>
<p>从Spring默认通过反射调用<strong>无参构造器获取对象</strong>。可以使用自定义的构造器注入一部分值和属性（比较少用），在Bean注册中用constructor-arg指定多个<strong>构造器参数</strong>，index指定参数的位置，type制定参数类型。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;driver&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.oracle.Driver&quot;</span>&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">constructor-arg</span> <span class="hljs-attr">index</span>=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;java.lang.String&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;老张&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">constructor-arg</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">constructor-arg</span> <span class="hljs-attr">index</span>=<span class="hljs-string">&quot;1&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;int&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;20&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">constructor-arg</span>&gt;</span><br> <span class="hljs-comment">&lt;!--构造器依赖注入 --&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">constructor-arg</span> <span class="hljs-attr">index</span>=<span class="hljs-string">&quot;3&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;car&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">constructor-arg</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h4 id="scope"><a href="#scope" class="headerlink" title="scope"></a>scope</h4><p>Spring容器中的Bean默认都是单例的（取多次都是同一个对象），bean的scope属性设为<strong>prototype</strong>，Bean变成多例，</p>
<p>request：request表示该针对每一次HTTP请求都会产生一个新的bean，同时该bean仅在当前HTTP request内有效</p>
<p>session：session表示该针对每一次HTTP请求都会产生一个新的bean，同时该bean仅在当前HTTP session</p>
<p>globalsession：global session作用域类似于标准的HTTP Session作用域，仅仅在基于portlet的web应用中才有意义</p>
<ul>
<li>@Scope ：xml里bean元素的scope属性，设定Bean的作用范围，也可以放在方法上。默认单例，Spring容器加载时就创建对象，prototype每一次获取Bean就创建</li>
<li>xml设置</li>
</ul>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">&lt;bean <span class="hljs-attribute">id</span>=<span class="hljs-string">&quot;driver&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-string">&quot;com.oracle.Driver&quot;</span> <span class="hljs-attribute">scope</span>=<span class="hljs-string">&quot;prototype&quot;</span>&gt;<br></code></pre></td></tr></table></figure>

<h4 id="生命周期方法"><a href="#生命周期方法" class="headerlink" title="生命周期方法"></a>生命周期方法</h4><p>在bean创建，或销毁时设置一个方法（很少用）</p>
<ul>
<li><p><strong>@PostConstruct和@PreDestroy</strong> ：Bean生命周期方法的注解（等于bean属性配置init-method&#x3D;”init”）</p>
</li>
<li><p>xml设置生命周期方法：在bean中设置属性一个<strong>init-menthod</strong>等于对象中的哪个方法</p>
</li>
<li><p>Spring配置</p>
</li>
</ul>
<h4 id="Spring-AOP"><a href="#Spring-AOP" class="headerlink" title="Spring AOP"></a>Spring AOP</h4><p>Spring AOP默认基于动态代理的，<strong>当类（切面）没有从一个接口继承而来时，会使用cglib代理</strong> 。SpringAOP是运行时进行编译生成代理类。AspectJ则是编译时织入，将切面织入到代码，没有使用代理模式</p>
<p>MenthodInterceptor是CGLIB代理。InvocationHandler接口是JDK代理，Spring本质上也是实现他们。</p>
<p>三种角色：真实对象、代理对象、角色</p>
<h4 id="AOP核心概念"><a href="#AOP核心概念" class="headerlink" title="AOP核心概念"></a>AOP核心概念</h4><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/github_34889651/article/details/51321499">AOP术语参考</a></p>
<p><strong>切面（aspect）</strong>、<strong>切入点（pointcut）</strong>、<strong>通知（advice）</strong>： 、<strong>织入（weaving）</strong></p>
<p>确定切面（哪个Bean），编写通知，设置通知的切入点（方法，角色），spring帮我们完成织入，生层代理对象</p>
<p>SpringAOP依赖于AspectJ的aspectjrt和aspectjweaver两个依赖，因为我们依赖与AspectJ框架的一些注解，一般不需要使用到AspectJ AOP框架，Spring AOP足够用</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">aop:aspect-antoproxy</span>/&gt;</span><br></code></pre></td></tr></table></figure>

<p>五种通知：begin、after（无论是否方法成功或失败）、around（包含被通知方法）、after-retuning（成功）、after-throwing（在这个方法抛出异常以后执行）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// Aspect注解标一个切面（aspect），是通知advice和切点pointcut的集合。并用Componet注解注册到容器</span><br><span class="hljs-meta">@Component</span><br><span class="hljs-meta">@Aspect</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DaoAspect</span> &#123;<br>  <span class="hljs-comment">// 定义一个切入点，供通知引用</span><br>    <span class="hljs-meta">@Pointcut(&quot;execution(public * tmall.controller.*.*Controller.*(..))&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">pointcut</span><span class="hljs-params">()</span> &#123;<br>    &#125;<br>  <br>  <span class="hljs-comment">// 直接在通知中配置切入点</span><br>    <span class="hljs-meta">@Before(&quot;execution(* com.oracle.dao.*.*(..))&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">begin</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;开启事务&quot;</span>);<br>    &#125;<br>    <span class="hljs-meta">@After(&quot;execution(* com.oracle.dao.*.*(..))&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">commit</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;提交事务&quot;</span>);<br>    &#125;<br>  <span class="hljs-comment">// 这种配置切入点也可以</span><br>    <span class="hljs-meta">@Around(&quot;pointcut()&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">(ProceedingJoinPoint joinPoint)</span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>          <span class="hljs-comment">// 代表原方法</span><br>            joinPoint.proceed();<br>        &#125; <span class="hljs-keyword">catch</span> (Throwable throwable) &#123;<br>            throwable.printStackTrace();<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure>

<p>xml配置切面的通知和切入点</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">aop:config</span>&gt;</span><br>  <span class="hljs-comment">&lt;!-- 配置aspect切面里的切入点和通知--&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">aop:aspect</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;time&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;timeHandler&quot;</span> <span class="hljs-attr">order</span>=<span class="hljs-string">&quot;1&quot;</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- HelloWorld类下的所有方法，任意参数，..代表0个以上参数--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">aop:pointcut</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;addTime&quot;</span> <span class="hljs-attr">expression</span>=<span class="hljs-string">&quot;execution(* com.xrq.aop.HelloWorld.*(..))&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">aop:before</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;printTime&quot;</span> <span class="hljs-attr">pointcut-ref</span>=<span class="hljs-string">&quot;addTime&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">aop:after</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;printTime&quot;</span> <span class="hljs-attr">pointcut-ref</span>=<span class="hljs-string">&quot;addTime&quot;</span> /&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">aop:aspect</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">aop:aspect</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;log&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;logHandler&quot;</span> <span class="hljs-attr">order</span>=<span class="hljs-string">&quot;2&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">aop:pointcut</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;printLog&quot;</span> <span class="hljs-attr">expression</span>=<span class="hljs-string">&quot;execution(* com.xrq.aop.HelloWorld.*(..))&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">aop:before</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;LogBefore&quot;</span> <span class="hljs-attr">pointcut-ref</span>=<span class="hljs-string">&quot;printLog&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">aop:after</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;LogAfter&quot;</span> <span class="hljs-attr">pointcut-ref</span>=<span class="hljs-string">&quot;printLog&quot;</span> /&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">aop:aspect</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">aop:config</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>如果一类应用了多个通知，执行顺序：</p>
<p>先执行所有前置通知，再执行所有后置通知，而且顺序相反，也就是如果一个类执行了A前置通知再执行了B前置通知，执行完方法后，先执行B后置通知，在执行A的后置通知</p>
<h4 id="Spring事务"><a href="#Spring事务" class="headerlink" title="Spring事务"></a>Spring事务</h4><p>Spring中，两种事务处理</p>
<ol>
<li>编程式事务： 通过代码来处理事务，如transactionManager.commit()，代码侵入性强</li>
<li>声明式事务：通过@Transaction注解或者xml处理事务，各有优缺点</li>
</ol>
<p>配置事务管理器的Bean：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- 核心事务管理器配置到spring（依赖数据源）--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;txManager&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;dataSource&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br></code></pre></td></tr></table></figure>

<ol>
<li>xml配置</li>
</ol>
<p>可以设置切点，注解是方法级别的，关于<a target="_blank" rel="noopener" href="https://juejin.im/post/5e6d993cf265da575b1bd4af#comment">Spring事务面试题</a></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- 事务管理器切面的设置 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">tx:advice</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;txAdvice&quot;</span> <span class="hljs-attr">transaction-manager</span>=<span class="hljs-string">&quot;txManager&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">tx:attributes</span>&gt;</span><br>     <span class="hljs-comment">&lt;!-- 对insert,create,update,modify,delete,remove 开头的方法进行事务管理,只要有异常就回滚，propagation定义Spring事务传播级别， --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">tx:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;insert*&quot;</span> <span class="hljs-attr">propagation</span>=<span class="hljs-string">&quot;REQUIRED&quot;</span> <span class="hljs-attr">rollback-for</span>=<span class="hljs-string">&quot;java.lang.Throwable&quot;</span>  <span class="hljs-attr">read-only</span>=<span class="hljs-string">&quot;false&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">tx:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;add*&quot;</span> <span class="hljs-attr">propagation</span>=<span class="hljs-string">&quot;REQUIRED&quot;</span> <span class="hljs-attr">rollback-for</span>=<span class="hljs-string">&quot;java.lang.Throwable&quot;</span>  <span class="hljs-attr">read-only</span>=<span class="hljs-string">&quot;false&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">tx:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;create*&quot;</span> <span class="hljs-attr">propagation</span>=<span class="hljs-string">&quot;REQUIRED&quot;</span> <span class="hljs-attr">rollback-for</span>=<span class="hljs-string">&quot;java.lang.Throwable&quot;</span>  <span class="hljs-attr">read-only</span>=<span class="hljs-string">&quot;false&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">tx:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;update*&quot;</span> <span class="hljs-attr">propagation</span>=<span class="hljs-string">&quot;REQUIRED&quot;</span> <span class="hljs-attr">rollback-for</span>=<span class="hljs-string">&quot;java.lang.Throwable&quot;</span>  <span class="hljs-attr">read-only</span>=<span class="hljs-string">&quot;false&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">tx:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;modify*&quot;</span> <span class="hljs-attr">propagation</span>=<span class="hljs-string">&quot;REQUIRED&quot;</span> <span class="hljs-attr">rollback-for</span>=<span class="hljs-string">&quot;java.lang.Throwable&quot;</span>  <span class="hljs-attr">read-only</span>=<span class="hljs-string">&quot;false&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">tx:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;delete*&quot;</span> <span class="hljs-attr">propagation</span>=<span class="hljs-string">&quot;REQUIRED&quot;</span> <span class="hljs-attr">rollback-for</span>=<span class="hljs-string">&quot;java.lang.Throwable&quot;</span>  <span class="hljs-attr">read-only</span>=<span class="hljs-string">&quot;false&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">tx:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;remove*&quot;</span> <span class="hljs-attr">propagation</span>=<span class="hljs-string">&quot;REQUIRED&quot;</span> <span class="hljs-attr">rollback-for</span>=<span class="hljs-string">&quot;java.lang.Throwable&quot;</span> <span class="hljs-attr">read-only</span>=<span class="hljs-string">&quot;false&quot;</span>/&gt;</span><br>    <span class="hljs-comment">&lt;!-- find,get,select,count开头的方法,开启只读,提高数据库访问性能 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">tx:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;find*&quot;</span> <span class="hljs-attr">read-only</span>=<span class="hljs-string">&quot;true&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">tx:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;get*&quot;</span> <span class="hljs-attr">read-only</span>=<span class="hljs-string">&quot;true&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">tx:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;select*&quot;</span> <span class="hljs-attr">read-only</span>=<span class="hljs-string">&quot;true&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">tx:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;count*&quot;</span> <span class="hljs-attr">read-only</span>=<span class="hljs-string">&quot;true&quot;</span> /&gt;</span><br>    <span class="hljs-comment">&lt;!-- 对其他方法 使用默认的事务管理 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">tx:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;*&quot;</span> /&gt;</span><br>	<span class="hljs-tag">&lt;/<span class="hljs-name">tx:attributes</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">tx:advice</span>&gt;</span><br><br><span class="hljs-comment">&lt;!-- AOP配置切面--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">aop:config</span>&gt;</span><br>  <span class="hljs-comment">&lt;!--配置切入点--&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">aop:pointcut</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;customerServiceOperation&quot;</span> <span class="hljs-attr">expression</span>=<span class="hljs-string">&quot;execution(* com.oracle.service.*ServiceImpl.*(..))&quot;</span> /&gt;</span><br>  <span class="hljs-comment">&lt;!--advisor配置器：通知和切入点绑定--&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">aop:advisor</span> <span class="hljs-attr">advice-ref</span>=<span class="hljs-string">&quot;txAdvice&quot;</span> <span class="hljs-attr">pointcut-ref</span>=<span class="hljs-string">&quot;customerServiceOperation&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">aop:config</span>&gt;</span><br><br></code></pre></td></tr></table></figure>

<ol start="2">
<li>注解配置</li>
</ol>
<p>@Transcational注解指定哪个方法或者类用事务</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- 由Annotation调度事务管理Bean  --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">tx:annotation-driven</span> <span class="hljs-attr">transaction-manager</span>=<span class="hljs-string">&quot;txManager&quot;</span> /&gt;</span><br></code></pre></td></tr></table></figure>

<h1 id="SpringMVC"><a href="#SpringMVC" class="headerlink" title="SpringMVC"></a>SpringMVC</h1><p>SprintMVC基本原理：浏览器发送请求，交给**核心控制器(DispatcherServlet)**，查找HandlderMapping中是否有对应的地址映射，如果存在要访问映射的控制器，先经过HandlerAdapter做类型自动转换、处理请求参数，访问Controller，Controller将模型数据和视图地址封装为ModelAndView对象交换给核心控制器，通过视图解析器为视图的地址添加前缀和后缀，向指定的视图层跳转。</p>
<h2 id="接收请求参数（URL编码）"><a href="#接收请求参数（URL编码）" class="headerlink" title="接收请求参数（URL编码）"></a>接收请求参数（URL编码）</h2><p>SprintMVC请求参数一定要在前端进行格式化，类型不匹配时则无法自动设值注入，返回400错误。</p>
<p>handle方法写什么就自动传入什么，如写HttpServeltRequest</p>
<h4 id="1-参数名映射"><a href="#1-参数名映射" class="headerlink" title="1. 参数名映射"></a>1. 参数名映射</h4><p>handle的方法参数和请求参数名字自动匹配，自动完成值注入</p>
<ol>
<li>情况一： 请求参数的名字 和方法参数的名字一致 ，直接就注入到方法参数中<ul>
<li>不写RequestParam时，引用类型没有传入参数时，不会报错，默认值为null；基本数据类型必须要传入参数</li>
<li>写RequestParam时，默认required时true。所有类型必须要参数，即User&#x2F;list?name&#x3D;?pwd&#x3D;，参数可以为空。</li>
</ul>
</li>
</ol>
<p>例如，访问的URL为：<a target="_blank" rel="noopener" href="http://localhost:8080/controller/hello?name=tom&age=20">http://localhost:8080/controller/hello?name=tom&age=20</a></p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">@RequestMapping(&quot;/hello&quot;)<br><span class="hljs-built_in">public</span> String hello(String <span class="hljs-type">name</span>,<span class="hljs-type">int</span> age)&#123;<br>	<span class="hljs-keyword">System</span>.<span class="hljs-keyword">out</span>.println(&quot;hello World:&quot;+<span class="hljs-type">name</span>+&quot;,age:&quot;+(age+<span class="hljs-number">1</span>));<br>	<span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<ol>
<li>情况二：请求参数的名字和方法参数的名字不致 ，通过**@RequestParam**（写在参数前面）指定名字映射</li>
</ol>
<p>例如，访问的URL为：<a target="_blank" rel="noopener" href="http://localhost:8080/controller/hello?name=tom&a=20">http://localhost:8080/controller/hello?name=tom&a=20</a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(&quot;/hello&quot;)</span><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">hello</span><span class="hljs-params">(String name,<span class="hljs-meta">@RequestParam(&quot;a&quot;)</span> <span class="hljs-type">int</span> age)</span>&#123;<br>	System.out.println(<span class="hljs-string">&quot;hello World:&quot;</span>+name+<span class="hljs-string">&quot;,age:&quot;</span>+(age+<span class="hljs-number">1</span>));<br>	<span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="2-对象名映射"><a href="#2-对象名映射" class="headerlink" title="2. 对象名映射"></a>2. 对象名映射</h4><ol>
<li>将请求参数注入到一个对象中，<strong>请求参数的名字和对象的属性名相同</strong>即可完成值的注入，不需要完整的对象属性</li>
</ol>
<p>例如 url：<a target="_blank" rel="noopener" href="http://localhost:8080/controller/hello?empno=110&ename=tom&tel=1234567">http://localhost:8080/controller/hello?empno=110&ename=tom&tel=1234567</a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(&quot;/hello&quot;)</span><br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">hello</span><span class="hljs-params">(Emp e)</span>&#123;<br>	e.getEmpno();<br>	<span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<ol>
<li>请求参数包含多个对象匹配</li>
</ol>
<p>参数重写多个对象，下面是一个对象带依赖</p>
<p>表单中包含员工数据和部门的数据 ，想把所有保存在Emp中，前端的依赖对象的name写<strong>依赖对象.属性，</strong>自动完成设值</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;/controller/hello&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;empno&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;ename&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;tel&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>      部门id：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;d.deptno&quot;</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;保存&quot;</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br>  @RequestMapping(&quot;/hello&quot;)<br>  public String hello(Emp e)&#123;<br>自动我们设置e对象中的d.deptno<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="3-Map貌似不能接受数据"><a href="#3-Map貌似不能接受数据" class="headerlink" title="3. Map貌似不能接受数据"></a>3. Map貌似不能接受数据</h4><h2 id="接受JSON数据"><a href="#接受JSON数据" class="headerlink" title="接受JSON数据"></a><strong>接受JSON数据</strong></h2><p>需要映射的前面加**@RequestBody**注解，可以有四种修饰，一般用下面的前两种</p>
<p>将请求体中的JSON&#x2F;xml字符串绑定到相应的bean上或绑定到对应的字符串上（会根据Content-Type，JSON、XML）），<strong>只能修饰最后一个参数</strong></p>
<p>如add（提交操作）时一般使用Ajax（好让前端提示添加失败，不会重置窗口），这是一般使用PO类来接受（尤其是单表）</p>
<p>list（页面动态信息）页面时，一般直接对应</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs typescript">   浏览器服务器 <br>  <span class="hljs-title class_">JSON</span>：&#123;属性名:属性值&#125;对象/<span class="hljs-title class_">Map</span><br>  [&#123;属性名:属性值&#125;,&#123;属性名:属性值&#125;]    <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">User</span>&gt;<br>  数组：[<span class="hljs-string">&quot;123&quot;</span>,<span class="hljs-string">&quot;456&quot;</span>] <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">String</span>&gt;<br>  <span class="hljs-title class_">StringString</span><br>  <br>  <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">login</span>(<span class="hljs-meta">@requestBody</span> <span class="hljs-title class_">String</span> userName, <span class="hljs-meta">@requestBody</span> <span class="hljs-title class_">String</span> pwd)<br>  <span class="hljs-title class_">JSON</span>：&#123;<span class="hljs-string">&quot;userName&quot;</span>:<span class="hljs-string">&quot;lee&quot;</span>, <span class="hljs-string">&quot;pwd&quot;</span>:<span class="hljs-string">&quot;123&quot;</span>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="向view传数据"><a href="#向view传数据" class="headerlink" title="向view传数据"></a><strong>向view传数据</strong></h2><ol>
<li><p>直接使用request对象（不推荐），下面这些方法设值的原理是核心控制器（dispatcherServlet）给我们request.setAttribute。</p>
</li>
<li><p>在Controller的方法参数中<strong>定义Map参数</strong>（最常用），不用request.setAttribute主要是为了做到和servlet-API的松耦合，可以脱离servile进行单元测试。</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs arduino">@<span class="hljs-built_in">RequestMapping</span>(<span class="hljs-string">&quot;/test1&quot;</span>)<br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">String</span> <span class="hljs-title">test1</span><span class="hljs-params">(<span class="hljs-type">String</span> name, Map map)</span></span>&#123;<br> map.<span class="hljs-built_in">put</span>(<span class="hljs-string">&quot;name&quot;</span>,<span class="hljs-string">&quot;toms&quot;</span>);<br> map.<span class="hljs-built_in">put</span>(<span class="hljs-string">&quot;age&quot;</span>,<span class="hljs-number">20</span>);<br> map.<span class="hljs-built_in">put</span>(<span class="hljs-string">&quot;emp&quot;</span>,<span class="hljs-keyword">new</span> <span class="hljs-built_in">Emp</span>());<br> <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;succ&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>在Controller的方法参数中<strong>定义Model&#x2F;ModelMap参数</strong></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-meta">@RequestMapping</span>(<span class="hljs-string">&quot;/test1&quot;</span>)<br><span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">test1</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> name, Model model</span>)&#123;<br> model.<span class="hljs-title function_">addAttribute</span>(<span class="hljs-string">&quot;name&quot;</span>,<span class="hljs-string">&quot;toms&quot;</span>);<br> model.<span class="hljs-title function_">addAttribute</span>(<span class="hljs-string">&quot;age&quot;</span>,<span class="hljs-number">20</span>);<br> model.<span class="hljs-title function_">addAttribute</span>(<span class="hljs-string">&quot;emp&quot;</span>,<span class="hljs-keyword">new</span> <span class="hljs-title class_">Emp</span>());<br> <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;succ&quot;</span>;<br>&#125;<br><br><span class="hljs-comment">// 会在进入访问该控制器的所有方法前，设定model的值</span><br><span class="hljs-meta">@ModelAttribute</span><br><span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">model</span>(<span class="hljs-params">Model model</span>) &#123;<br>   model.<span class="hljs-title function_">addAttribute</span>(<span class="hljs-string">&quot;message&quot;</span>, <span class="hljs-string">&quot;注解成功&quot;</span>);<br>&#125;<br><br></code></pre></td></tr></table></figure>
</li>
<li><p>封装到ModelAndView对象中，ModleAndView对象可以放在参数当中生成</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-meta">@RequestMapping</span>(<span class="hljs-string">&quot;/test2&quot;</span>)<br><span class="hljs-keyword">public</span> <span class="hljs-title class_">ModelAndView</span> <span class="hljs-title function_">test2</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> name</span>)&#123;<br> <span class="hljs-title class_">ModelAndView</span> modelAndView = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ModelAndView</span>(<span class="hljs-string">&quot;/fail&quot;</span>);<br> modelAndView.<span class="hljs-title function_">addObject</span>(<span class="hljs-string">&quot;name&quot;</span>,<span class="hljs-string">&quot;toms&quot;</span>);<br> modelAndView.<span class="hljs-title function_">addObject</span>(<span class="hljs-string">&quot;age&quot;</span>,<span class="hljs-number">20</span>);<br> modelAndView.<span class="hljs-title function_">addObject</span>(<span class="hljs-string">&quot;emp&quot;</span>,<span class="hljs-keyword">new</span> <span class="hljs-title class_">Emp</span>());<br> <span class="hljs-keyword">return</span> modelAndView;<br>&#125;<br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="向view跳转"><a href="#向view跳转" class="headerlink" title="向view跳转"></a><strong>向view跳转</strong></h2><p>Controller的状态和handler返回值有关，默认跳转。ServletController不做操作时返回空白到字符串。</p>
<ul>
<li>**return ResponseEntity&lt;byte[]&gt;**：用于文件下载</li>
<li>带ResponseBody注解，向浏览器发送JSON数据：</li>
</ul>
<h3 id="return跳转"><a href="#return跳转" class="headerlink" title="return跳转"></a>return跳转</h3><p>两种方式，无论是哪种 ，核心控制器获得的都是ModelAndView</p>
<ol>
<li><p>直接return 字符串：跳转的地址</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-meta">@RequestMapping</span>(<span class="hljs-string">&quot;/test1&quot;</span>)<br><span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">test1</span>(<span class="hljs-params"></span>)&#123;<br> <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;/succ.jsp&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>直接return ModelAndView对象 ，跳转的地址封装到这个对象中</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-meta">@RequestMapping</span>(<span class="hljs-string">&quot;/test2&quot;</span>)<br><span class="hljs-keyword">public</span> <span class="hljs-title class_">ModelAndView</span> <span class="hljs-title function_">test2</span>(<span class="hljs-params"></span>)&#123;<br> <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ModelAndView</span>(<span class="hljs-string">&quot;/fail.jsp&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p><strong>return void时，必须resp向浏览器返回数据或用request跳转</strong>，否则返回404&#x2F;500</p>
</li>
</ol>
<p>⚠️：默认forward，如果在地址字符串中包含 forward: 或 redirect:  就不经过视图解析器</p>
<ul>
<li>请求转发跳转 jsp : 不写forward</li>
<li>重定向jsp ： “redirect: uri”</li>
<li>请求转发跳转 Controller : 地址的字符串中 “forward: controller的uri”</li>
<li>重定向 Controller : “redirect: uri”</li>
</ul>
<p>SpringMVC拦截器</p>
<h2 id="SpringMVC拦截器"><a href="#SpringMVC拦截器" class="headerlink" title="SpringMVC拦截器"></a><strong>SpringMVC拦截器</strong></h2><p>要HandleMapping映射成功才会进入拦截器</p>
<h3 id="拦截器和过滤器的区别"><a href="#拦截器和过滤器的区别" class="headerlink" title="拦截器和过滤器的区别"></a>拦截器和过滤器的区别</h3><ul>
<li>过滤器是用来拦截jsp、servlet请求的，拦截器用来拦截<strong>SpringMVC框架中Controller</strong></li>
<li>过滤器依赖Servlet容器中，不依赖servlet，因为SpringMVC Controller是在Spring容器中的</li>
<li>通过调用chain.doFilter方法执行后续内容，拦截器是通过return true&#x2F;false 决定是否执行后续内容。</li>
<li>过滤器基于函数回调，过滤器基于动态代理，要继承HandleInterception</li>
<li>拦截器能获得参数，并修改参数（净网活动）</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/fjnmbb12/article/details/74001567">拦截器参考</a></p>
<h3 id="拦截器三个方法"><a href="#拦截器三个方法" class="headerlink" title="拦截器三个方法"></a>拦截器三个方法</h3><p>preHandle顺向，postHandle和afterCompletion逆向，主要是拦截Controller</p>
<p><strong>继承HandlerInterceptorAdapter或者实现HandlerInterceptor</strong>，<strong>推荐继承</strong>，这样可以选择想要的重写的方法</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-built_in">public</span> <span class="hljs-keyword">class</span> MyInterceptor implements HandlerInterceptor&#123;<br> <span class="hljs-comment">/**</span><br><span class="hljs-comment">  * preHandle方法在Controller的handler方法前进行调用。</span><br><span class="hljs-comment">  * 如有多个Interceptor，SpringMVC会根据声明的前后顺序一个接一个的执行，</span><br><span class="hljs-comment">  * 主要用于身份认证（验证非法登陆）</span><br><span class="hljs-comment">  */</span><br> @Override<br> <span class="hljs-built_in">public</span> <span class="hljs-type">boolean</span> preHandle(HttpServletRequest httpServletRequest, HttpServletResponsehttpServletResponse, <span class="hljs-keyword">Object</span> <span class="hljs-keyword">handler</span>) throws <span class="hljs-keyword">Exception</span> &#123;<br>   //闸门<br>   startTime = <span class="hljs-keyword">System</span>.currentTimeMillis(); <br>   <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>&#125;<br><br> <span class="hljs-comment">/**</span><br><span class="hljs-comment">  * postHandle在Interceptor的preHandle方法返回值为true的时候才会执行 </span><br><span class="hljs-comment">  * 在Controller的方法调用之后，在DispatcherServlet进行视图的渲染之前执行</span><br><span class="hljs-comment">  * 在这个方法中可以对ModelAndView统一定制。比如菜单导航</span><br><span class="hljs-comment">  */</span><br> @Override<br> <span class="hljs-built_in">public</span> <span class="hljs-type">void</span> postHandle(HttpServletRequest httpServletRequest, HttpServletResponse<br>                        httpServletResponse, <span class="hljs-keyword">Object</span> o, ModelAndView modelAndView) throwsException &#123;<br>   <span class="hljs-keyword">object</span> o可以获得请求对象的参数，和设置<br>     //Controller 执行完毕后 要执行的代码 endTime = <span class="hljs-keyword">System</span>.currentTimeMillis(); <span class="hljs-keyword">System</span>.<span class="hljs-keyword">out</span>.println(endTime-startTime);<br>&#125;<br> <span class="hljs-comment">/**</span><br><span class="hljs-comment">  * preHandle方法的返回值为true时才会执行。</span><br><span class="hljs-comment">  * 该方法将在整个请求完成之后，也就是DispatcherServlet渲染了视图后执行。</span><br><span class="hljs-comment">  * 该方法可用于清理一些资源：统一的异常处理，日志处理</span><br><span class="hljs-comment">  */</span><br> @Override<br> <span class="hljs-built_in">public</span> <span class="hljs-type">void</span> afterCompletion&#123;&#125;<br></code></pre></td></tr></table></figure>

<h1 id="spring-xml配置"><a href="#spring-xml配置" class="headerlink" title="spring xml配置"></a>spring xml配置</h1><h2 id="扫描注解"><a href="#扫描注解" class="headerlink" title="扫描注解"></a>扫描注解</h2><p>xml需要加上context的xml命名空间和context的schema验证文件，Springboot不需要配置Spring注解的扫描</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">context:component-scan</span> <span class="hljs-attr">base-package</span>=<span class="hljs-string">&quot;com.oracle&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">context:exclude-filter</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;regex&quot;</span> <span class="hljs-attr">expression</span>=<span class="hljs-string">&quot;com.oracle.intelagr.controller&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">context:component-scan</span>&gt;</span><br><br><span class="hljs-comment">&lt;!-- 可以用调整包括范围 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">context:including-filter</span>/&gt;</span><br><br><span class="hljs-comment">&lt;!-- 不推荐使用，这个只配置了普通的context:componetscan代替--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">context:annotation-config</span>/&gt;</span><br><br></code></pre></td></tr></table></figure>

<h2 id="读取properties文件"><a href="#读取properties文件" class="headerlink" title="读取properties文件"></a>读取properties文件</h2><p>通过类似于EL表达式的${ }，在XML或者Spring注解中，引入properties文件里面的值。另外习惯性通过资源文件（加载Locale读取不同配置文件）国际化</p>
<p>添加Spring配置文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">context:property-placeholder</span> <span class="hljs-attr">location</span>=<span class="hljs-string">&quot;classpath：applicationContext.properties&quot;</span>/&gt;</span><br><span class="hljs-comment">&lt;!--多个时，可以选择这种方式--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;propertyConfigurer&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.beans.factory.config.PropertyPlaceholderConfigurer&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;location&quot;</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>application.properties<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>jdbc.properties<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br></code></pre></td></tr></table></figure>

<h2 id="Spring整合Mybatis"><a href="#Spring整合Mybatis" class="headerlink" title="Spring整合Mybatis"></a>Spring整合Mybatis</h2><p>Spring无缝整合SpringMVC，主要需要整合mybatis到Spring中。</p>
<p>mybatis-Spring包，SpringDate里的：sqlSessionTemplate()模板类。</p>
<h3 id="数据源-x2F-连接池"><a href="#数据源-x2F-连接池" class="headerlink" title="数据源&#x2F;连接池"></a>数据源&#x2F;连接池</h3><p>数据源是数据库的抽象映射，一个数据源对应一个数据库，连接池是数据库的代理，每一次增删改，都要连接一次，非常耗时间，很多容器都给我们提供了<strong>连接池代替数据源</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- 这里使用DriverManager使用JDBC数据源 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;driverClassName&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span> /&gt;</span> <br><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;url&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;jdbc:mysql://localhost:3306/cmp?useUnicode=true<span class="hljs-symbol">&amp;amp;</span>characterEncoding=utf8&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;root&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;root&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br></code></pre></td></tr></table></figure>

<h3 id="sqlSessionFactory"><a href="#sqlSessionFactory" class="headerlink" title="sqlSessionFactory"></a>sqlSessionFactory</h3><p>将mybatsi的<strong>SqlSession工厂注册到Spring容器中</strong>，<strong>注入数据源到Mybatis</strong>，设值注入要扫描实体包的包位置。这个是必须配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- sqlSessionFactory注册在Spring容器中，同时注入数据源Bean--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;sqlSessionFactory&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;dataSource&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-comment">&lt;!-- 扫描实体类所在的包，将实体类别名包 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;typeAliasesPackage&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;com.oracle.ssm.entity&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br></code></pre></td></tr></table></figure>

<h3 id="Mapper扫描器"><a href="#Mapper扫描器" class="headerlink" title="Mapper扫描器"></a>Mapper扫描器</h3><p>注册Mapper扫描器，配置扫描Mapper接口的包位置（<strong>Mapper接口和Mapper.xml名字的包要一致</strong>），自动创建Mapper接口的代理对象（以前通过getMapper方法）。Mapper的代理对象(dao层)已经在Spring容器中，只需要我们用注解注入。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;mapperScanner&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;</span>&gt;</span><br>  <span class="hljs-comment">&lt;!-- 过时：&lt;property name=&quot;sqlSessionFactory&quot; ref=&quot;sqlSessionFactory&quot;&gt; --&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;sqlSessionFactoryBeanName&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;sqlSessionFactory&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;basePackage&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;com.oracle.cmp.mapper&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br></code></pre></td></tr></table></figure>

<p>除了使用mapper扫描器，自动完成接口绑定和mapper代理类的生成。</p>
<p>也可以使用sqlsessiontemplate完成、</p>
<h3 id="数据库事务管理器"><a href="#数据库事务管理器" class="headerlink" title="数据库事务管理器"></a>数据库事务管理器</h3><p>需要的业务方法或者业务类由@Transcation调度</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;txManager&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">*</span>&quot;<span class="hljs-attr">dataSource</span>&quot; <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;dataSource&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><span class="hljs-comment">&lt;!-- 由Annotation调度事务管理Bean --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">tx:annotation-driven</span> <span class="hljs-attr">transaction-manager</span>=<span class="hljs-string">*</span>&quot;<span class="hljs-attr">txManager</span>&quot; /&gt;</span><br><br></code></pre></td></tr></table></figure>

<h2 id="SpringMVC配置文件"><a href="#SpringMVC配置文件" class="headerlink" title="SpringMVC配置文件"></a>SpringMVC配置文件</h2><p>可以使用<a target="_blank" rel="noopener" href="https://juejin.im/post/5dcd0c8851882510a3712f72">类配置SpringMVC</a>，做到类似于SpringBoot（不推荐）</p>
<ol>
<li><p>web.xml配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- 配置监听器，项目一加载，就加载Spring容器，并加载Spring配置文件--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">listener</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="hljs-tag">&lt;/<span class="hljs-name">listener-class</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">listener</span>&gt;</span><br><span class="hljs-comment">&lt;!-- content-param在启动时会存在servletContext对象(application)中 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">context-param</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>contextConfigLocation<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>classpath:applicationContext.xml<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">context-param</span>&gt;</span><br><br><span class="hljs-comment">&lt;!--配置springmvc 核心控制器DispatcherServlet，并指定dispatcherServlet配置文件的路径--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">servlet</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>springmvc<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-class</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">load-on-startup</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">load-on-startup</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">init-param</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--配置springmvc配置文件的位置，如果配置文件名改了名，必须要配置--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>contextConfigLocation<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>classpath:springmvc-servlet.xml<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">init-param</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">servlet</span>&gt;</span><br><br><span class="hljs-comment">&lt;!-- 拦截所有带斜杠的请求，以前是配置/*.do、/*.xhtml，防静态资源，但是非Rest风格 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">servlet-mapping</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>springmvc<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">servlet-mapping</span>&gt;</span><br><br><span class="hljs-comment">&lt;!-- 用Springweb给我们提供的字符过滤器 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">filter</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">filter-name</span>&gt;</span>encodingFilter<span class="hljs-tag">&lt;/<span class="hljs-name">filter-name</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="hljs-tag">&lt;/<span class="hljs-name">filter-class</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">init-param</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>encoding<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>UTF-8<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">init-param</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">init-param</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">param-name</span>&gt;</span>forceEncoding<span class="hljs-tag">&lt;/<span class="hljs-name">param-name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">param-value</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">param-value</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">init-param</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">filter</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">filter-mapping</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">filter-name</span>&gt;</span>encodingFilter<span class="hljs-tag">&lt;/<span class="hljs-name">filter-name</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/*<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">filter-mapping</span>&gt;</span><br><br></code></pre></td></tr></table></figure>
</li>
<li><p>配置MVC的dispatcherServlet，servletname名字随便起，默认是servlet名-servlet.xml</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_30038111/article/details/79722624">关于SpringMVC静态资源的处理</a></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--拓充MVC的注解 请求参数的注解和装载数据注解等等 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mvc:annotation-driven</span>/&gt;</span><br><span class="hljs-comment">&lt;!-- MVC需要单独扫描Controller  --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">context:component-scan</span> <span class="hljs-attr">base-package</span>=<span class="hljs-string">&quot;com.oracle.controller&quot;</span>/&gt;</span><br><br><span class="hljs-comment">&lt;!-- SimpleUrlHandlerMapping，Controller的Bean配置，一般用注解扫描代替 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;helloController&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;controller.HelloController&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span> <br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;simpleUrlHandlerMapping&quot;</span></span><br><span class="hljs-tag">      <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.web.servlet.handler.SimpleUrlHandlerMapping&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;mappings&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">props</span>&gt;</span><br>      <span class="hljs-comment">&lt;!-- /hello 路径的请求交给 id 为 helloController 的控制器处理--&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">prop</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;/hello&quot;</span>&gt;</span>helloController<span class="hljs-tag">&lt;/<span class="hljs-name">prop</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">props</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br><span class="hljs-comment">&lt;!--  指定项目的静态资源注册到SimpleUrlHandlerMapping，</span><br><span class="hljs-comment">   **表示路径映射两级文件夹，打破了传统文件夹只能放在web根目录下的限制，</span><br><span class="hljs-comment">   mapping代表映射后的路径，并且可以设置cacheControl</span><br><span class="hljs-comment">   默认配置静态资源：，&lt;mvc:default-servlet-handler /&gt; </span><br><span class="hljs-comment">   表示没有mapping，就去默认路径找，但是不能指定任意位置   --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mvc:resources</span> <span class="hljs-attr">mapping</span>=<span class="hljs-string">&quot;/js/**&quot;</span> <span class="hljs-attr">location</span>=<span class="hljs-string">&quot;/js/&quot;</span> <span class="hljs-attr">cache-period</span>=<span class="hljs-string">&quot;31556926&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mvc:resources</span> <span class="hljs-attr">mapping</span>=<span class="hljs-string">&quot;/style/**&quot;</span> <span class="hljs-attr">location</span>=<span class="hljs-string">&quot;/style/&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mvc:resources</span> <span class="hljs-attr">mapping</span>=<span class="hljs-string">&quot;/upload/**&quot;</span> <span class="hljs-attr">location</span>=<span class="hljs-string">&quot;/upload/&quot;</span> /&gt;</span><br><br><span class="hljs-comment">&lt;!-- 拦截器，SpringMVC提供的类似Filter的工具，用来拦截handler，可以不写--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mvc:interceptors</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">mvc:interceptor</span> &gt;</span><br>    <span class="hljs-comment">&lt;!-- 拦截哪个Controller，优先级高 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">mvc:mapping</span> <span class="hljs-attr">path</span>=<span class="hljs-string">&quot;/testController&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.oracle.common.MyInterceptor&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span> <br>  <span class="hljs-tag">&lt;/<span class="hljs-name">mvc:interceptor</span>&gt;</span><br>  <br>  <span class="hljs-tag">&lt;<span class="hljs-name">mvc:interceptor</span> &gt;</span>                            <br>    <span class="hljs-tag">&lt;<span class="hljs-name">mvc:mapping</span> <span class="hljs-attr">path</span>=<span class="hljs-string">&quot;/test*&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.oracle.common.MyInterceptor2&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span> <br>  <span class="hljs-tag">&lt;/<span class="hljs-name">mvc:interceptor</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">mvc:interceptors</span>&gt;</span><br><br><span class="hljs-comment">&lt;!-- 配置viewResolver视图解析器，thymeleaf需要配置view.ThymeleafViewResolver这个解析 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;viewResolver&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;prefix&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;/pages/&quot;</span> /&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;suffix&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;.jsp&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br><span class="hljs-comment">&lt;!-- 文件上传解析器 multipart --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;multipartResolver&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.web.multipart.commons.CommonsMultipartResolver&quot;</span>/&gt;</span><br>	<span class="hljs-comment">&lt;!-- 上传文件大小上限，单位为字节（10MB）,可选 --&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;maxUploadSize&quot;</span>&gt;</span>  <br>  	<span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>10485760<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>  <br>	<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>  <br>	<span class="hljs-comment">&lt;!-- 请求的编码格式，必须和jSP的pageEncoding属性一致，以便正确读取表单的内容，可选 --&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;defaultEncoding&quot;</span>&gt;</span><br>  	<span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>UTF-8<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>	<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br></code></pre></td></tr></table></figure></li>
</ol>
<h1 id="SpringBoot配置"><a href="#SpringBoot配置" class="headerlink" title="SpringBoot配置"></a>SpringBoot配置</h1><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Thinkingcao/article/details/86613066">SpringBoot静态目录</a>、<a target="_blank" rel="noopener" href="https://blog.csdn.net/u011144425/article/details/79225864">静态目录</a>、<a target="_blank" rel="noopener" href="http://wuwenliang.net/2018/07/10/Springboot%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE%E9%AD%94%E6%B3%95%E4%B9%8B%E8%87%AA%E5%AE%9A%E4%B9%89starter/">SpringBoot starter原理</a></p>
<h3 id="thymeleaf"><a href="#thymeleaf" class="headerlink" title="thymeleaf"></a><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/53848414">thymeleaf</a></h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment"># 配置JSP，不推荐</span><br><span class="hljs-attr">spring.view.prefix</span>=<span class="hljs-string">/WEB-INF/views/</span><br><span class="hljs-attr">spring.view.suffix</span>=<span class="hljs-string">.jsp</span><br><span class="hljs-comment"># 默认配置，可以选择不配置：</span><br><span class="hljs-attr">spring.thymeleaf.mode</span>=<span class="hljs-string">HTML5</span><br><span class="hljs-attr">spring.thymeleaf.encoding</span>=<span class="hljs-string">UTF-8</span><br><span class="hljs-attr">spring.thymeleaf.content-type</span>=<span class="hljs-string">text/html;charset=&lt;encoding&gt;</span><br><span class="hljs-attr">spring.thymeleaf.prefix</span>=<span class="hljs-string">classpath:/templates/</span><br><span class="hljs-attr">spring.thymeleaf.suffix</span>=<span class="hljs-string">.html</span><br><span class="hljs-comment"># 一般缓存设置为false, 这样修改之后马上生效，便于调试</span><br><span class="hljs-attr">spring.thymeleaf.cache</span>=<span class="hljs-string">false</span><br><br></code></pre></td></tr></table></figure>

<ul>
<li>变量名同样用用{}EL表达式，文件路径src用@{}</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">th:each</span>=<span class="hljs-string">&quot;s:$&#123;students&#125;&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">&quot;$&#123;s.id&#125;&quot;</span>&gt;</span>id<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">&quot;$&#123;s.name&#125;&quot;</span>&gt;</span>name<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br><br><span class="hljs-comment">&lt;!-- 当students集合为空则显示提示信息,用了thymeleaf内置工具#list的isEmpty方法，</span><br><span class="hljs-comment">		 可以用$&#123;num == 6&#125;或者$&#123;!empty user&#125;直接EL逻辑运算--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">th:if</span>=<span class="hljs-string">&quot;$&#123;#lists.isEmpty(students)&#125;&quot;</span>&gt;</span>studnets集合为空！<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-comment">&lt;!-- 当students集合不为空时才会显示下面的元素 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">th:if</span>=<span class="hljs-string">&quot;$&#123;not #lists.isEmpty(students)&#125;&quot;</span>&gt;</span><br>  <br><span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">th:class</span>=<span class="hljs-string">&quot;$&#123;status.even&#125;?&#x27;even&#x27;:&#x27;odd&#x27;&quot;</span>&gt;</span><br>  <br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;../../webapp/static/js/thymeleaf.js&quot;</span> <span class="hljs-attr">th:src</span>=<span class="hljs-string">&quot;@&#123;/static/js/thymeleaf.js&#125;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;#&quot;</span>  <span class="hljs-attr">th:href</span>=<span class="hljs-string">&quot;@&#123;/static/js/thymeleaf.js&#125;&quot;</span> &gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">th:inline</span>=<span class="hljs-string">&quot;javascript&quot;</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">  <span class="hljs-keyword">var</span> stu = [[$&#123;student&#125;]];</span><br><span class="language-javascript">  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(stu.<span class="hljs-property">name</span> + <span class="hljs-string">&quot;/&quot;</span> + stu.<span class="hljs-property">id</span>);</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br></code></pre></td></tr></table></figure>

<p>定义fragment组件： th:fragment&#x3D;”footer1”、th:include&#x3D;”include::footer1”、th:replace&#x3D;”include::footer1”、layout:decorator、layout:fragment</p>
<h3 id="SpringBoot-MVC"><a href="#SpringBoot-MVC" class="headerlink" title="SpringBoot MVC"></a>SpringBoot MVC</h3><p>实现WebMvcConfigurer，作为配置类，不要继承WebMvcConfigurerAdapter，相当于@Configuration+@Enablespringmvc。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WebConfigurer</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">WebMvcConfigurer</span> &#123;<br>	<span class="hljs-meta">@Autowired</span><br>  LoginIneerceptor loginInterceptor; <br>  <span class="hljs-comment">//重写addInterceptor方法配置拦截器的地址，SpringBoot常用autowired+component注入Interceptor</span><br>  <span class="hljs-meta">@Override</span><br>	 <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addInterceptors</span><span class="hljs-params">(InterceptorRegistry registry)</span> &#123;<br>        registry.addInterceptor(LoginInterceptor()).addPathPatterns(<span class="hljs-string">&quot;/**&quot;</span>);<br>	 &#125;<br>  <span class="hljs-comment">//重写addCorsMappings配置全局CORS；也可以注入一个CorsFilter的一个Bean来配置</span><br>	 <span class="hljs-meta">@Override</span>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addCorsMappings</span><span class="hljs-params">(CorsRegistry registry)</span> &#123;  <br>        registry.addMapping(<span class="hljs-string">&quot;/**&quot;</span>)  <br>                .allowCredentials(<span class="hljs-literal">true</span>)  <br>                .allowedHeaders(<span class="hljs-string">&quot;*&quot;</span>)  <br>                .allowedOrigins(<span class="hljs-string">&quot;*&quot;</span>)  <br>                .allowedMethods(<span class="hljs-string">&quot;*&quot;</span>);  <br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>






                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
</div>


              

              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/12/12/%E6%95%B0%E6%8D%AE%E5%BA%93/2022-12-12-%E7%B4%A2%E5%BC%95/" title="数据库加索引">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">数据库加索引</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/05/26/Java/Java%E5%9F%BA%E7%A1%802/" title="">
                        <span class="hidden-mobile"></span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  <article id="comments" lazyload>
    
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js', function() {
        var options = Object.assign(
          {"appId":"AxRSoPrgAA1n3akIHe4aBQ2Y-gzGzoHsz","appKey":"CYOBLQ2l1KRnfhA3E4xX91CI","path":"window.location.pathname","placeholder":"给我评论点啥","avatar":"retro","meta":["nick","mail","link"],"requiredFields":[],"pageSize":10,"lang":"zh-CN","highlight":true,"recordIP":true,"serverURLs":null,"emojiCDN":null,"emojiMaps":null,"enableQQ":false,"appid":"AxRSoPrgAA1n3akIHe4aBQ2Y-gzGzoHsz","appkey":"CYOBLQ2l1KRnfhA3E4xX91CI"},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          var imgSelector = '#valine .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


  </article>


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        总访问量 
        <span id="leancloud-site-pv"></span>
         次
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        总访客数 
        <span id="leancloud-site-uv"></span>
         人
      </span>
    
    

  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://cdn.jsdelivr.net/npm/tocbot@4.12.0/dist/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://cdn.jsdelivr.net/npm/anchor-js@4.3.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
